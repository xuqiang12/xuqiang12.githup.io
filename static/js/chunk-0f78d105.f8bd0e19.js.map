{"version":3,"sources":["webpack:///./node_modules/core-js/modules/esnext.string.replace-all.js","webpack:///./src/components/BaseCom/uploadImg/index.vue?3b68","webpack:///./src/components/BaseCom/uploadImg/index.vue?c643","webpack:///src/components/BaseCom/uploadImg/index.vue","webpack:///./src/components/BaseCom/uploadImg/index.vue?bb40","webpack:///./src/components/BaseCom/uploadImg/index.vue"],"names":["$","requireObjectCoercible","isRegExp","getRegExpFlags","wellKnownSymbol","IS_PURE","REPLACE","RegExpPrototype","RegExp","prototype","target","proto","replaceAll","searchValue","replaceValue","IS_REG_EXP","flags","replacer","string","searchString","template","result","position","index","O","this","String","call","indexOf","TypeError","undefined","replace","split","join","length","render","_vm","_h","$createElement","_c","_self","ref","class","showMainGraph","listType","limit","fileList","attrs","handleSuccess","handleError","action","accept","multiple","headers","previewfile","beforeAvatarUpload","scopedSlots","_u","key","fn","file","directives","name","rawName","value","item","list","group","expression","uid","staticClass","url","staticStyle","on","sortFormat","model","callback","$$v","mainGraph","_v","_e","$event","handlePictureCardPreview","disabled","handleDownload","handleRemove","slot","_s","uploadTips","dialogVisible","dialogImageUrl","dialogState","staticRenderFns","components","preview","props","type","default","imgList","size","data","show","sizeFlag","changeflag","computed","token","watch","handler","newValue","oldValue","mounted","active","methods","response","fileArr","filePath","changes","arr","downloadByBlob","image","canvas","ctx","eleLink","URL","component"],"mappings":"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","file":"static/js/chunk-0f78d105.f8bd0e19.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar isRegExp = require('../internals/is-regexp');\nvar getRegExpFlags = require('../internals/regexp-flags');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar RegExpPrototype = RegExp.prototype;\n\n// `String.prototype.replaceAll` method\n// https://github.com/tc39/proposal-string-replace-all\n$({ target: 'String', proto: true }, {\n  replaceAll: function replaceAll(searchValue, replaceValue) {\n    var O = requireObjectCoercible(this);\n    var IS_REG_EXP, flags, replacer, string, searchString, template, result, position, index;\n    if (searchValue != null) {\n      IS_REG_EXP = isRegExp(searchValue);\n      if (IS_REG_EXP) {\n        flags = String(requireObjectCoercible('flags' in RegExpPrototype\n          ? searchValue.flags\n          : getRegExpFlags.call(searchValue)\n        ));\n        if (!~flags.indexOf('g')) throw TypeError('`.replaceAll` does not allow non-global regexes');\n      }\n      replacer = searchValue[REPLACE];\n      if (replacer !== undefined) {\n        return replacer.call(searchValue, O, replaceValue);\n      } else if (IS_PURE && IS_REG_EXP) {\n        return String(O).replace(searchValue, replaceValue);\n      }\n    }\n    string = String(O);\n    searchString = String(searchValue);\n    if (searchString === '') return replaceAll.call(string, /(?:)/g, replaceValue);\n    template = string.split(searchString);\n    if (typeof replaceValue !== 'function') {\n      return template.join(String(replaceValue));\n    }\n    result = template[0];\n    position = result.length;\n    for (index = 1; index < template.length; index++) {\n      result += String(replaceValue(searchString, position, string));\n      position += searchString.length + template[index].length;\n      result += template[index];\n    }\n    return result;\n  }\n});\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=3a3cd8cc&prod&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-upload',{ref:\"uploadFile\",class:{'showMainGraph':_vm.showMainGraph&&_vm.listType==='picture-card', 'limit':_vm.limit<=_vm.fileList.length},attrs:{\"on-success\":_vm.handleSuccess,\"on-error\":_vm.handleError,\"action\":_vm.action,\"file-list\":_vm.fileList,\"limit\":_vm.limit,\"accept\":_vm.accept,\"multiple\":_vm.multiple,\"headers\":_vm.headers,\"on-preview\":_vm.previewfile,\"list-type\":_vm.listType,\"before-upload\":_vm.beforeAvatarUpload,\"auto-upload\":true},scopedSlots:_vm._u([{key:\"file\",fn:function(ref){\nvar file = ref.file;\nreturn (_vm.listType==='picture-card')?_c('div',{directives:[{name:\"dragging\",rawName:\"v-dragging\",value:({ item: file, list: _vm.fileList, group: 'uid' }),expression:\"{ item: file, list: fileList, group: 'uid' }\"}],key:file.uid,staticClass:\"imgItem\"},[_c('div',{staticClass:\"itemcard\"},[_c('img',{staticClass:\"el-upload-list__item-thumbnail\",attrs:{\"src\":file.url,\"alt\":\"\"}}),(_vm.showMainGraph)?_c('el-radio',{staticStyle:{\"height\":\"20px\",\"line-height\":\"20px\",\"width\":\"100%\",\"text-align\":\"center\",\"color\":\"#606266\",\"cursor\":\"pointer\"},attrs:{\"label\":file.uid},on:{\"change\":_vm.sortFormat},model:{value:(_vm.mainGraph),callback:function ($$v) {_vm.mainGraph=$$v},expression:\"mainGraph\"}},[_vm._v(\"设为主图\")]):_vm._e(),_c('span',{staticClass:\"el-upload-list__item-actions\"},[_c('span',{staticClass:\"el-upload-list__item-preview\",on:{\"click\":function($event){return _vm.handlePictureCardPreview(file)}}},[_c('i',{staticClass:\"el-icon-zoom-in\"})]),(!_vm.disabled)?_c('span',{staticClass:\"el-upload-list__item-delete\",on:{\"click\":function($event){return _vm.handleDownload(file)}}},[_c('i',{staticClass:\"el-icon-download\"})]):_vm._e(),(!_vm.disabled)?_c('span',{staticClass:\"el-upload-list__item-delete\",on:{\"click\":function($event){return _vm.handleRemove(file,_vm.fileList )}}},[_c('i',{staticClass:\"el-icon-delete\"})]):_vm._e()])],1)]):_vm._e()}}],null,true)},[(_vm.listType==='picture-card')?_c('i',{staticClass:\"el-icon-plus\",attrs:{\"slot\":\"default\"},slot:\"default\"}):_vm._e(),(_vm.listType!=='picture-card')?_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传\")]):_vm._e(),(_vm.uploadTips)?_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(_vm._s(_vm.uploadTips))]):_vm._e()],1),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})]),_c('preview',{attrs:{\"dialog-state\":_vm.dialogState}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\r\n * @Description: 文件内容描述\r\n * @Author: 编辑人\r\n * @Date: 2021-09-16 09:33:38\r\n-->\r\n<template>\r\n  <div>\r\n    <el-upload\r\n      ref=\"uploadFile\"\r\n      :on-success=\"handleSuccess\"\r\n      :on-error=\"handleError\"\r\n      :action=\"action\"\r\n      :file-list=\"fileList\"\r\n      :limit=\"limit\"\r\n      :accept=\"accept\"\r\n      :multiple=\"multiple\"\r\n      :headers=\"headers\"\r\n      :on-preview=\"previewfile\"\r\n      :list-type=\"listType\"\r\n      :before-upload=\"beforeAvatarUpload\"\r\n      :auto-upload=\"true\"\r\n      :class=\"{'showMainGraph':showMainGraph&&listType==='picture-card', 'limit':limit<=fileList.length}\"\r\n    >\r\n      <i v-if=\"listType==='picture-card'\" slot=\"default\" class=\"el-icon-plus\" />\r\n      <div v-if=\"listType==='picture-card'\" slot=\"file\" :key=\"file.uid\" slot-scope=\"{ file }\" v-dragging=\"{ item: file, list: fileList, group: 'uid' }\" class=\"imgItem\">\r\n        <div class=\"itemcard\">\r\n          <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\">\r\n          <el-radio v-if=\"showMainGraph\" v-model=\"mainGraph\" :label=\"file.uid\" style=\"height: 20px;line-height: 20px;width: 100%;text-align: center;color: #606266; cursor: pointer;\" @change=\"sortFormat\">设为主图</el-radio>\r\n          <span class=\"el-upload-list__item-actions\">\r\n            <span class=\"el-upload-list__item-preview\" @click=\"handlePictureCardPreview(file)\">\r\n              <i class=\"el-icon-zoom-in\" />\r\n            </span>\r\n            <span v-if=\"!disabled\" class=\"el-upload-list__item-delete\" @click=\"handleDownload(file)\">\r\n              <i class=\"el-icon-download\" />\r\n            </span>\r\n            <span v-if=\"!disabled\" class=\"el-upload-list__item-delete\" @click=\"handleRemove(file,fileList )\">\r\n              <i class=\"el-icon-delete\" />\r\n            </span>\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <el-button v-if=\"listType!=='picture-card'\" size=\"small\" type=\"primary\">点击上传</el-button>\r\n      <div v-if=\"uploadTips\" slot=\"tip\" class=\"el-upload__tip\">{{ uploadTips }}</div>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n    </el-dialog>\r\n    <preview :dialog-state=\"dialogState\" />\r\n  </div>\r\n</template>\r\n<script>\r\n/**\r\n * \t * 安装方法\r\n * 一、安装插件 ：cnpm install awe-dnd --save 或者 npm install awe-dnd --save\r\n * 二：在main.js中配置\r\n * //引入拖拽排序插件\r\n    import VueDND from 'awe-dnd'\r\n    Vue.use(VueDND)\r\n    使用：\r\n    v-dragging=\"{ item: file, list: fileList, group: 'uid' }\"\r\n    { list:你列表的数据, item: 是当前循环值 , group:你唯一的键，注意一个里面只有一个}\r\n   */\r\nimport { getToken } from \"@/utils/auth\";\r\nexport default {\r\n  name: \"UploadImg\",\r\n  components: {\r\n    preview: () => import('@/components/BaseCom/preview/index'),\r\n  },\r\n  props: {\r\n    listType: { // 图片列表类型 text/picture/picture-card\r\n      type: String,\r\n      default: function() {\r\n        return \"picture-card\";\r\n      }\r\n    },\r\n    imgList: {\r\n      // 回显图片地址数组\r\n      type: Array,\r\n      default: function() {\r\n        return [];\r\n      },\r\n    },\r\n    showMainGraph: {\r\n      // 是否显示设为主图\r\n      type: Boolean,\r\n      default: function() {\r\n        return false;\r\n      },\r\n    },\r\n    multiple: { // 是否多图上传\r\n      type: Boolean,\r\n      default: function() {\r\n        return true;\r\n      },\r\n    },\r\n    limit: { // 上传最大数量\r\n      type: Number,\r\n      default: function() {\r\n        return 99;\r\n      }\r\n    },\r\n    action: { // 上传文件地址\r\n      type: String,\r\n      default: function() {\r\n        return (this.$fileUrl + '/api/v1/file/upload')\r\n      }\r\n    },\r\n    accept: { // 能上传的文件格式\r\n      type: String,\r\n      default: function() {\r\n        return \".jpg,.gif,.png,.svg,.webp\";\r\n      }\r\n    },\r\n    size: { // 上传文件大小   单位MB\r\n      type: Number,\r\n      default: function() {\r\n        return 3;\r\n      }\r\n    },\r\n    uploadTips: { // 上传提示\r\n      type: String,\r\n      default: function() {\r\n        return \"\";\r\n      }\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      dialogState: { show: false, url: '' },\r\n      mainGraph: \"\",\r\n      dialogImageUrl: \"\",\r\n      dialogVisible: false,\r\n      disabled: false,\r\n      fileList: [],\r\n      sizeFlag: false,\r\n      changeflag: true\r\n    };\r\n  },\r\n  computed: {\r\n    headers() {\r\n      return { token: getToken() };\r\n    }\r\n  },\r\n  watch: {\r\n    imgList: { // 当数据发生改变时，会自动去计算\r\n      handler(newValue, oldValue) {\r\n        if (this.changeflag) {\r\n          this.fileList = this.imgList.map(item => ({ url: item, }));\r\n        }\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.fileList = this.imgList.map((item, index, arr) => {\r\n      const nameList = item.replaceAll(\"\\\\\", \"/\").split(\"/\")\r\n      return { url: item, active: true, name: nameList[nameList.length - 1] };\r\n    })\r\n    this.$dragging.$on('dragged', (res) => { // 拖动图片排序\r\n      this.fileList = res.value.list\r\n      this.sortFormat()\r\n    })\r\n    if (this.showMainGraph) {\r\n      this.$nextTick(() => {\r\n        this.mainGraph = this.fileList[0].uid\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    previewfile(file) {\r\n      this.dialogState = { show: true, url: file.filePath }\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const size = file.size / 1024 / 1024 < parseInt(this.size);\r\n      if (!size) {\r\n        this.$message.error('上传文件不得大于' + parseInt(this.size) + 'MB!');\r\n      }\r\n      this.sizeFlag = size\r\n      return size;\r\n    },\r\n    handleRemove(file, fileList) {\r\n      this.fileList = fileList.filter((value, index) => value.uid !== file.uid)\r\n      if (this.showMainGraph && file.uid === this.mainGraph) {\r\n        this.$nextTick(() => {\r\n          this.mainGraph = this.fileList[0].uid\r\n        })\r\n      }\r\n      this.sortFormat()\r\n    },\r\n    handleSuccess(response, file, fileList) {\r\n      let fileArr = []\r\n      if (response.status === 0) {\r\n        fileArr = fileList.map(item => {\r\n          return { ...item, filePath: item.response.data.natureUrl }\r\n        })\r\n        this.changes(fileArr)\r\n        return;\r\n      }\r\n      const index = this.$refs.uploadFile.uploadFiles.findIndex(item => item.uid === file.uid) // 查出uid对应的数据  uploadFiles是upload $refs下的方法\r\n      this.$refs.uploadFile.uploadFiles.splice(index, 1) // 删除该条数据\r\n      this.$messagee(response.message)\r\n    },\r\n    handleError() { },\r\n    changes(fileList) {\r\n      if (this.sizeFlag) {\r\n        this.fileList = fileList\r\n        this.sortFormat()\r\n      }\r\n    },\r\n    sortFormat() { // 将数据格式整理成数组的第一条为主图\r\n      this.changeflag = false\r\n      const arr = []\r\n      this.fileList.forEach(element => {\r\n        if (element.size) {\r\n          if (element.uid === this.mainGraph) {\r\n            arr.unshift(element.filePath)\r\n          } else {\r\n            arr.push(element.filePath)\r\n          }\r\n        } else {\r\n          if (element.uid === this.mainGraph) {\r\n            arr.unshift(element.url)\r\n          } else {\r\n            arr.push(element.url)\r\n          }\r\n        }\r\n      });\r\n      // 通过vue.async实现子组件修改父组件数据\r\n      this.$emit('update:imgList', arr, () => { // 完成修改后在将监听打开\r\n        this.changeflag = true\r\n      })\r\n    },\r\n    handlePictureCardPreview(file) { // 查看大图\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    handleDownload(file) { // 调用下载图片\r\n      this.downloadByBlob(file.url, file.name)\r\n    },\r\n    downloadByBlob(url, name) { // 前端通过地址下载图片\r\n      const image = new Image()\r\n      image.setAttribute('crossOrigin', 'anonymous')\r\n      image.src = url\r\n      image.onload = () => {\r\n        const canvas = document.createElement('canvas')\r\n        canvas.width = image.width\r\n        canvas.height = image.height\r\n        const ctx = canvas.getContext('2d')\r\n        ctx.drawImage(image, 0, 0, image.width, image.height)\r\n        canvas.toBlob((blob) => {\r\n          const url = URL.createObjectURL(blob)\r\n          const eleLink = document.createElement('a')\r\n          eleLink.download = name\r\n          eleLink.href = url\r\n          eleLink.click()\r\n          eleLink.remove()\r\n          // 用完释放URL对象\r\n          URL.revokeObjectURL(url)\r\n        })\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n<style lang=\"scss\" >\r\n.showMainGraph {\r\n  .el-upload-list .el-upload-list__item {\r\n    height: 183px;\r\n    border-radius: 0;\r\n    border: none;\r\n    .imgItem {\r\n      height: 100%;\r\n      .itemcard {\r\n        height: 100%;\r\n        .el-upload-list__item-thumbnail {\r\n          height: calc(100% - 35px);\r\n          line-height: 0;\r\n          border-radius: 6px;\r\n          border: 1px solid #c0ccda;\r\n        }\r\n        .el-upload-list__item-actions {\r\n          height: calc(100% - 35px);\r\n          border-radius: 6px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n// .thumbnail {\r\n//   .el-upload-list .el-upload-list__item {\r\n//     height: 70px;\r\n//     border-radius: 0;\r\n//     border: none;\r\n//     .imgItem {\r\n//       height: 100%;\r\n//       .itemcard {\r\n//         height: 100%;\r\n//         .el-upload-list__item-thumbnail {\r\n//           height: 100%;\r\n//           line-height: 0;\r\n//           border-radius: 6px;\r\n//           border: 1px solid #c0ccda;\r\n//         }\r\n//         .el-upload-list__item-actions {\r\n//           height: 100%;\r\n//           border-radius: 6px;\r\n//         }\r\n//       }\r\n//     }\r\n//   }\r\n// }\r\n// .uploadImg {\r\n//   .el-upload-list .el-upload-list__item {\r\n//     height: 148px;\r\n//     border-radius: 0;\r\n//     border: none;\r\n//     .imgItem {\r\n//       height: 100%;\r\n//       .itemcard {\r\n//         height: 100%;\r\n//         .el-upload-list__item-thumbnail {\r\n//           height: 100%;\r\n//           line-height: 0;\r\n//           border-radius: 6px;\r\n//           border: 1px solid #c0ccda;\r\n//         }\r\n//         .el-upload-list__item-actions {\r\n//           height: 100%;\r\n//           border-radius: 6px;\r\n//         }\r\n//       }\r\n//     }\r\n//   }\r\n// }\r\n.limit {\r\n  .el-upload {\r\n    display: none;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3a3cd8cc&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=3a3cd8cc&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}