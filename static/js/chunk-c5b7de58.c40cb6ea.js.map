{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./node_modules/core-js/modules/esnext.string.replace-all.js","webpack:///./src/components/BaseCom/uploadFile/index.vue?e76a","webpack:///src/components/BaseCom/uploadFile/index.vue","webpack:///./src/components/BaseCom/uploadFile/index.vue?a4d8","webpack:///./src/components/BaseCom/uploadFile/index.vue","webpack:///./src/components/BaseCom/uploadFile/index.vue?4110"],"names":["$","$find","find","addToUnscopables","arrayMethodUsesToLength","FIND","SKIPS_HOLES","USES_TO_LENGTH","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","requireObjectCoercible","isRegExp","getRegExpFlags","wellKnownSymbol","IS_PURE","REPLACE","RegExpPrototype","RegExp","prototype","replaceAll","searchValue","replaceValue","IS_REG_EXP","flags","replacer","string","searchString","template","result","position","index","O","String","call","indexOf","TypeError","replace","split","join","render","_vm","_h","$createElement","_c","_self","ref","class","showMainGraph","listType","limit","fileList","attrs","handleSuccess","handleError","handleRemove","handleExceed","realmName","action","accept","multiple","headers","previewfile","beforeAvatarUpload","scopedSlots","_u","key","fn","file","directives","name","rawName","value","item","list","group","expression","uid","staticClass","url","staticStyle","on","sortFormat","model","callback","$$v","mainGraph","_v","_e","$event","handlePictureCardPreview","disabled","handleDownload","slot","_s","uploadTips","dialogVisible","dialogImageUrl","dialogState","staticRenderFns","components","preview","prop","event","props","type","default","size","interceptName","data","show","sizeFlag","computed","token","mounted","methods","statusBeforeUpload","response","alias","status","downloadByBlob","image","canvas","ctx","eleLink","URL","component"],"mappings":"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","file":"static/js/chunk-c5b7de58.c40cb6ea.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","'use strict';\nvar $ = require('../internals/export');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar isRegExp = require('../internals/is-regexp');\nvar getRegExpFlags = require('../internals/regexp-flags');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar RegExpPrototype = RegExp.prototype;\n\n// `String.prototype.replaceAll` method\n// https://github.com/tc39/proposal-string-replace-all\n$({ target: 'String', proto: true }, {\n  replaceAll: function replaceAll(searchValue, replaceValue) {\n    var O = requireObjectCoercible(this);\n    var IS_REG_EXP, flags, replacer, string, searchString, template, result, position, index;\n    if (searchValue != null) {\n      IS_REG_EXP = isRegExp(searchValue);\n      if (IS_REG_EXP) {\n        flags = String(requireObjectCoercible('flags' in RegExpPrototype\n          ? searchValue.flags\n          : getRegExpFlags.call(searchValue)\n        ));\n        if (!~flags.indexOf('g')) throw TypeError('`.replaceAll` does not allow non-global regexes');\n      }\n      replacer = searchValue[REPLACE];\n      if (replacer !== undefined) {\n        return replacer.call(searchValue, O, replaceValue);\n      } else if (IS_PURE && IS_REG_EXP) {\n        return String(O).replace(searchValue, replaceValue);\n      }\n    }\n    string = String(O);\n    searchString = String(searchValue);\n    if (searchString === '') return replaceAll.call(string, /(?:)/g, replaceValue);\n    template = string.split(searchString);\n    if (typeof replaceValue !== 'function') {\n      return template.join(String(replaceValue));\n    }\n    result = template[0];\n    position = result.length;\n    for (index = 1; index < template.length; index++) {\n      result += String(replaceValue(searchString, position, string));\n      position += searchString.length + template[index].length;\n      result += template[index];\n    }\n    return result;\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-upload',{ref:\"uploadFile\",class:{'showMainGraph':_vm.showMainGraph&&_vm.listType==='picture-card', 'limit':_vm.limit<=_vm.fileList.length},attrs:{\"on-success\":_vm.handleSuccess,\"on-error\":_vm.handleError,\"on-remove\":_vm.handleRemove,\"on-exceed\":_vm.handleExceed,\"action\":_vm.realmName+_vm.action,\"file-list\":_vm.fileList,\"limit\":_vm.limit,\"accept\":_vm.accept,\"multiple\":_vm.multiple,\"headers\":_vm.headers,\"on-preview\":_vm.previewfile,\"list-type\":_vm.listType,\"before-upload\":_vm.beforeAvatarUpload,\"auto-upload\":true},scopedSlots:_vm._u([{key:\"file\",fn:function(ref){\nvar file = ref.file;\nreturn (_vm.listType==='picture-card')?_c('div',{directives:[{name:\"dragging\",rawName:\"v-dragging\",value:({ item: file, list: _vm.fileList, group: 'uid' }),expression:\"{ item: file, list: fileList, group: 'uid' }\"}],key:file.uid,staticClass:\"imgItem\"},[_c('div',{staticClass:\"itemcard\"},[_c('img',{staticClass:\"el-upload-list__item-thumbnail\",attrs:{\"src\":file.url,\"alt\":\"\"}}),(_vm.showMainGraph)?_c('el-radio',{staticStyle:{\"height\":\"20px\",\"line-height\":\"20px\",\"width\":\"100%\",\"text-align\":\"center\",\"color\":\"#606266\",\"cursor\":\"pointer\"},attrs:{\"label\":file.uid},on:{\"change\":_vm.sortFormat},model:{value:(_vm.mainGraph),callback:function ($$v) {_vm.mainGraph=$$v},expression:\"mainGraph\"}},[_vm._v(\"设为主图\")]):_vm._e(),_c('span',{staticClass:\"el-upload-list__item-actions\"},[_c('span',{staticClass:\"el-upload-list__item-preview\",on:{\"click\":function($event){return _vm.handlePictureCardPreview(file)}}},[_c('i',{staticClass:\"el-icon-zoom-in\"})]),(!_vm.disabled)?_c('span',{staticClass:\"el-upload-list__item-delete\",on:{\"click\":function($event){return _vm.handleDownload(file)}}},[_c('i',{staticClass:\"el-icon-download\"})]):_vm._e(),(!_vm.disabled)?_c('span',{staticClass:\"el-upload-list__item-delete\",on:{\"click\":function($event){return _vm.handleRemove(file,_vm.fileList )}}},[_c('i',{staticClass:\"el-icon-delete\"})]):_vm._e()])],1)]):_vm._e()}}],null,true)},[(_vm.listType==='picture-card')?_c('i',{staticClass:\"el-icon-plus\",attrs:{\"slot\":\"default\"},slot:\"default\"}):_vm._e(),(_vm.listType!=='picture-card')?_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传\")]):_vm._e(),(_vm.uploadTips)?_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(_vm._s(_vm.uploadTips))]):_vm._e()],1),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})]),_c('preview',{attrs:{\"dialog-state\":_vm.dialogState}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <el-upload\r\n      ref=\"uploadFile\"\r\n      :on-success=\"handleSuccess\"\r\n      :on-error=\"handleError\"\r\n      :on-remove=\"handleRemove\"\r\n      :on-exceed=\"handleExceed\"\r\n      :action=\"realmName+action\"\r\n      :file-list=\"fileList\"\r\n      :limit=\"limit\"\r\n      :accept=\"accept\"\r\n      :multiple=\"multiple\"\r\n      :headers=\"headers\"\r\n      :on-preview=\"previewfile\"\r\n      :list-type=\"listType\"\r\n      :before-upload=\"beforeAvatarUpload\"\r\n      :auto-upload=\"true\"\r\n      :class=\"{'showMainGraph':showMainGraph&&listType==='picture-card', 'limit':limit<=fileList.length}\"\r\n    >\r\n      <i v-if=\"listType==='picture-card'\" slot=\"default\" class=\"el-icon-plus\" />\r\n      <div v-if=\"listType==='picture-card'\" slot=\"file\" :key=\"file.uid\" slot-scope=\"{ file }\" v-dragging=\"{ item: file, list: fileList, group: 'uid' }\" class=\"imgItem\">\r\n        <div class=\"itemcard\">\r\n          <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\">\r\n          <el-radio v-if=\"showMainGraph\" v-model=\"mainGraph\" :label=\"file.uid\" style=\"height: 20px;line-height: 20px;width: 100%;text-align: center;color: #606266; cursor: pointer;\" @change=\"sortFormat\">设为主图</el-radio>\r\n          <span class=\"el-upload-list__item-actions\">\r\n            <span class=\"el-upload-list__item-preview\" @click=\"handlePictureCardPreview(file)\">\r\n              <i class=\"el-icon-zoom-in\" />\r\n            </span>\r\n            <span v-if=\"!disabled\" class=\"el-upload-list__item-delete\" @click=\"handleDownload(file)\">\r\n              <i class=\"el-icon-download\" />\r\n            </span>\r\n            <span v-if=\"!disabled\" class=\"el-upload-list__item-delete\" @click=\"handleRemove(file,fileList )\">\r\n              <i class=\"el-icon-delete\" />\r\n            </span>\r\n          </span>\r\n        </div>\r\n      </div>\r\n      <el-button v-if=\"listType!=='picture-card'\" size=\"small\" type=\"primary\">点击上传</el-button>\r\n      <div v-if=\"uploadTips\" slot=\"tip\" class=\"el-upload__tip\">{{ uploadTips }}</div>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\r\n    </el-dialog>\r\n    <preview :dialog-state=\"dialogState\" />\r\n  </div>\r\n</template>\r\n<script>\r\n/**\r\n * \t * 安装方法\r\n * 一、安装插件 ：cnpm install awe-dnd --save 或者 npm install awe-dnd --save\r\n * 二：在main.js中配置\r\n * //引入拖拽排序插件\r\n    import VueDND from 'awe-dnd'\r\n    Vue.use(VueDND)\r\n    使用：\r\n    v-dragging=\"{ item: file, list: fileList, group: 'uid' }\"\r\n    { list:你列表的数据, item: 是当前循环值 , group:你唯一的键，注意一个里面只有一个}\r\n   */\r\nimport { getToken } from \"@/utils/auth\";\r\nexport default {\r\n  name: \"UploadFile\",\r\n  components: {\r\n    preview: () => import('@/components/BaseCom/preview/index'),\r\n  },\r\n  model: {\r\n    prop: 'fileList',\r\n    event: 'updateFileList', // 随便命名事件，对应下面$emit即可\r\n  },\r\n  props: {\r\n    listType: { // 图片列表类型 text/picture/picture-card\r\n      type: String,\r\n      default: function() {\r\n        return \"picture-card\";\r\n      }\r\n    },\r\n    fileList: { // 回显图片地址数组\r\n      type: Array,\r\n      default: function() {\r\n        return [];\r\n      }\r\n    },\r\n    showMainGraph: {\r\n      // 是否显示设为主图\r\n      type: Boolean,\r\n      default: function() {\r\n        return false;\r\n      },\r\n    },\r\n    multiple: { // 是否多图上传\r\n      type: Boolean,\r\n      default: function() {\r\n        return true;\r\n      },\r\n    },\r\n    limit: { // 上传最大数量\r\n      type: Number,\r\n      default: function() {\r\n        return 99;\r\n      }\r\n    },\r\n    action: { // 上传文件地址\r\n      type: String,\r\n      default: function() {\r\n        return '/api/v1/file/upload'\r\n      }\r\n    },\r\n    accept: { // 能上传的文件格式\r\n      type: String,\r\n      default: function() {\r\n        return \".jpg,.gif,.png,.svg,.webp\";\r\n      }\r\n    },\r\n    size: { // 上传文件大小   单位MB\r\n      type: Number,\r\n      default: function() {\r\n        return 3;\r\n      }\r\n    },\r\n\r\n    uploadTips: { // 上传提示\r\n      type: String,\r\n      default: function() {\r\n        return \"\";\r\n      }\r\n    },\r\n    interceptName: { // 是否截取地址作为文件名\r\n      type: Boolean,\r\n      default: function() {\r\n        return false;\r\n      }\r\n    },\r\n\r\n  },\r\n  data() {\r\n    return {\r\n      dialogState: { show: false, url: '' },\r\n      mainGraph: \"\",\r\n      dialogImageUrl: \"\",\r\n      dialogVisible: false,\r\n      disabled: false,\r\n      sizeFlag: false,\r\n    };\r\n  },\r\n  computed: {\r\n    headers() {\r\n      return { token: getToken() };\r\n    },\r\n    realmName() { // 请求域名\r\n      return this.$fileUrl;\r\n    },\r\n  },\r\n  mounted() {\r\n    if (this.interceptName) {\r\n      this.fileList = this.fileList.map(item => {\r\n        const nameList = item.url.replaceAll(\"\\\\\", \"/\").split(\"/\")\r\n        return { ...item, name: nameList[nameList.length - 1] };\r\n      })\r\n    }\r\n    this.$dragging.$on('dragged', (res) => { // 拖动图片排序\r\n      this.sortFormat()\r\n    })\r\n    if (this.showMainGraph && this.fileList.length > 0) {\r\n      this.$nextTick(() => {\r\n        // 格式化数据  显示主图时先给数据添加上主图标识\r\n        this.$emit('updateFileList', this.fileList.map(item => { return { mainGraph: false, ...item, } }))\r\n        const tempMainGraph = this.fileList.find(item => item.mainGraph)\r\n        this.mainGraph = this.fileList.some(item => item.mainGraph) ? tempMainGraph.uid : this.fileList[0].uid\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    beforeAvatarUpload(file) { // 上传前验证文件大小\r\n      let statusBeforeUpload = null;\r\n      let size = true\r\n      if (this.size) {\r\n        size = file.size / 1024 / 1024 < parseInt(this.size);\r\n        if (!size) {\r\n          this.$message.error('上传文件不得大于' + parseInt(this.size) + 'MB!');\r\n        }\r\n        this.sizeFlag = size\r\n      }\r\n      // 调用父组件的方法 可以在父组件中配置验证规则 使用 callback(status) 回调函数传递验证结果 status为true或false\r\n      // JSON.stringify(status) === 'undefined' || JSON.stringify(status) === 'null' ? true : status  判断是否有返回值\r\n      this.$emit('on-before-upload', file, status => { statusBeforeUpload = JSON.stringify(status) === 'undefined' || JSON.stringify(status) === 'null' ? true : status })\r\n      return statusBeforeUpload && size;\r\n    },\r\n    handleExceed() {\r\n      this.$message.error('最多只能上传' + this.limit + '个文件');\r\n    },\r\n    handleSuccess(response, file, fileList) {\r\n      // this.fileList.push(response)\r\n      if (response.status === 0) {\r\n        const fileArr = fileList.map(item => {\r\n          if (item.response) {\r\n            return { uid: file.uid, mainGraph: false, name: response.data.originName ? response.data.originName : file.name, url: response.data.natureUrl, alias: response.data.fileName, status: file.status }\r\n            // return { uid: file.uid, mainGraph: false, name: file.name, url: response.data.natureUrl, alias: response.data.fileName, status: file.status }\r\n          } else {\r\n            return item\r\n          }\r\n        })\r\n        this.$emit('updateFileList', fileArr)\r\n        return;\r\n      }\r\n      const index = this.$refs.uploadFile.uploadFiles.findIndex(item => item.uid === file.uid) // 查出uid对应的数据  uploadFiles是upload $refs下的方法\r\n      this.$refs.uploadFile.uploadFiles.splice(index, 1) // 删除该条数据\r\n      this.$messagee(response.message)\r\n    },\r\n    handleRemove(file) {\r\n      this.fileList.splice(this.fileList.findIndex(item => item.uid === file.uid), 1) // 删除该条数据\r\n    },\r\n    handleError() { // 上传失败\r\n\r\n    },\r\n    sortFormat() { // 将数据格式整理成数组的第一条为主图\r\n      this.$emit('updateFileList', this.fileList.map(item => { return { ...item, mainGraph: item.uid === this.mainGraph } }))\r\n    },\r\n    handlePictureCardPreview(file) { // 查看大图\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    handleDownload(file) { // 调用下载图片\r\n      this.downloadByBlob(file.url, file.name)\r\n    },\r\n    downloadByBlob(url, name) { // 前端通过地址下载图片\r\n      const image = new Image()\r\n      image.setAttribute('crossOrigin', 'anonymous')\r\n      image.src = url\r\n      image.onload = () => {\r\n        const canvas = document.createElement('canvas')\r\n        canvas.width = image.width\r\n        canvas.height = image.height\r\n        const ctx = canvas.getContext('2d')\r\n        ctx.drawImage(image, 0, 0, image.width, image.height)\r\n        canvas.toBlob((blob) => {\r\n          const url = URL.createObjectURL(blob)\r\n          const eleLink = document.createElement('a')\r\n          eleLink.download = name\r\n          eleLink.href = url\r\n          eleLink.click()\r\n          eleLink.remove()\r\n          // 用完释放URL对象\r\n          URL.revokeObjectURL(url)\r\n        })\r\n      }\r\n    },\r\n    previewfile(file) { // 预览文件\r\n      this.dialogState = { show: true, url: file.url }\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" >\r\n.showMainGraph {\r\n  .el-upload-list .el-upload-list__item {\r\n    height: 183px;\r\n    border-radius: 0;\r\n    border: none;\r\n    .imgItem {\r\n      height: 100%;\r\n      .itemcard {\r\n        height: 100%;\r\n        .el-upload-list__item-thumbnail {\r\n          height: calc(100% - 35px);\r\n          line-height: 0;\r\n          border-radius: 6px;\r\n          border: 1px solid #c0ccda;\r\n        }\r\n        .el-upload-list__item-actions {\r\n          height: calc(100% - 35px);\r\n          border-radius: 6px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n.limit {\r\n  .el-upload {\r\n    display: none;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=558a8654&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=558a8654&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=558a8654&prod&lang=scss&\""],"sourceRoot":""}